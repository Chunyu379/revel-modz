/*! sample 2014-03-04 */

function initComm(){$("#send_msg_btn").click(function(){websock_comm.Send($("#comm_input").val())}),websock_comm.AddHandler("error",error_handler),websock_comm.AddHandler("ack",ack_handler),websock_comm.Connect(window.location.host,"/comm")}function error_handler(a){console.log("Recv'd ERROR: "+a)}function ack_handler(a){console.log("Recv'd ACK: "+a)}function init_dynatree(){$("#tree").dynatree({checkbox:!0,classNames:{checkbox:"dynatree-radio"},selectMode:1,children:[],onSelect:function(a,b){b.isSelected()?(null!=b.data.theFile&&displayFileContents(b.data.theFile),null==b.data.contents&&getStoredFileContents(b),iassic.curr_dataset=b.data):($("#file-contents").text(""),iassic.curr_dataset=null)},onDblClick:function(a){a.toggleSelect()},onKeydown:function(a,b){return 32==b.which?(a.toggleSelect(),!1):void 0},cookieId:"dynatree-Cb1",idPrefix:"dynatree-Cb1-"}),getStoredFiles(),$("#tree").dynatree("getRoot").sortChildren(file_cmp,!0)}function displayFileContents(){var a=new FileReader;a.onload=function(a){return function(b){dataSetFromMyFormat(a.name,b.target.results)}}(file),a.readAsText(file)}function openFileOption(){document.getElementById("filedata").click()}function uploadDataFiles(a){function b(a){console.log("ERROR: Line ",a.lineno," in ",a.filename,": ",a.message)}$("#progress-bar").css("display","block");var c=$("#upload-progress");c.width("0%");for(var d=0,e=0,f=0,g=a.length;g>f;f++){var h=a[f];lfn=h.webkitRelativePath,"."!=lfn[lfn.length-1]&&(d+=1,e+=h.size)}console.log("total size: ",e);var i=0,j=new Worker("/public/js/workers/dirupload.js");j.onmessage=function(a){return console.log(a.data),i+=parseInt(a.data),i>=e?void $("#progress-bar").css("display","none"):(console.log("Worker said: ",a.data,"   rsz",i),void c.width(100*i/e+"%"))},j.onerror=b;for(var k=$("#tree").dynatree("getTree"),f=0,g=a.length;g>f;f++){var l=a[f];if(lfn=l.webkitRelativePath,lfn_parts=lfn.split("/"),"."!=lfn[lfn.length-1])for(var m="",n=$("#tree").dynatree("getRoot"),o=0,p=lfn_parts.length;p>o;o++){m+=lfn_parts[o]+"/";var q=k.getNodeByKey(m);if(null==q){var r=!1;p>o+1&&(r=!0);var s=lfn_parts[o],t={title:s,key:m,isFolder:r,hideCheckbox:r,theFile:l},u={Name:s,Path:m,Folder:r,Size:0,Content:"",Csrf:$("#csrf_token").val()};if(r)j.postMessage(JSON.stringify(u));else{var v=new FileReader;v.onload=function(a,b){return function(c){a.Content=c.target.result,a.Size=a.Content.length,b.postMessage(JSON.stringify(a))}}(u,j),v.readAsText(l)}q=n.addChild(t),k.redraw()}n=q}}$("#tree").dynatree("getRoot").sortChildren(file_cmp,!0)}function getStoredFiles(){console.log("Getting stored files"),req=new XMLHttpRequest,req.onreadystatechange=function(){4==req.readyState&&200==req.status&&displayStoredFiles(req.responseText)},req.open("GET","/files/query",!1),req.send()}function displayStoredFiles(){if(files=JSON.parse(req.responseText),null!=files){console.log(files.length);for(var a=$("#tree").dynatree("getTree"),b=0,c=files.length;c>b;b++){var d=files[b];lfn=d.Path,lfn_parts=lfn.split("/");for(var e="",f=$("#tree").dynatree("getRoot"),g=0,h=lfn_parts.length;h>g;g++)if(""!=lfn_parts[g]){e+=lfn_parts[g]+"/";var i=a.getNodeByKey(e);if(null==i){var j=d.Folder,k=lfn_parts[g],l={title:k,key:e,isFolder:j,hideCheckbox:j,theFile:null,data_id:d.DataSetId};i=f.addChild(l)}f=i}a.redraw()}}}function getStoredFileContents(a){req=new XMLHttpRequest,console.log("node: ",a.data.data_id),req.onreadystatechange=function(a){return function(){4==req.readyState&&200==req.status&&(a.data.content=req.responseText,dataSetFromMyFormat(a.data.title,a.data.content))}}(a),req.open("POST","/files/content?data_id="+a.data.data_id,!1),req.send()}function initEpicEditor(){opts={container:"epiceditor",textarea:null,basePath:"/ipa/css/epiceditor",clientSideStorage:!0,localStorageName:"epiceditor",useNativeFullscreen:!0,parser:marked,file:{name:"epiceditor",defaultContent:"",autoSave:100},theme:{base:"/themes/base/epiceditor.css",preview:"/themes/preview/github.css",editor:"/themes/editor/epic-dark.css"},button:{preview:!0,fullscreen:!1,bar:!0},focusOnLoad:!1,shortcut:{modifier:18,fullscreen:70,preview:80},autogrow:{minHeight:200,scroll:!0},string:{togglePreview:"Toggle Preview Mode",toggleEdit:"Toggle Edit Mode",toggleFullscreen:"Enter Fullscreen"},autogrow:!1},editor=new EpicEditor(opts).load()}var keep_file1=!0,file_cmp=function(a,b){return fa=a.data.isFolder,fb=b.data.isFolder,fa&&!fb?-1:fb&&!fa?1:(a=a.data.title.toLowerCase(),b=b.data.title.toLowerCase(),a>b?1:b>a?-1:0)},editor=null,opts={};
//# sourceMappingURL=sample.min.map